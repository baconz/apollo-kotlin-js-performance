<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Hello, Kotlin/JS!</title>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/benchmark@2.1.4/benchmark.min.js"></script>
    <script src="shared.js"></script>
</head>
<body>
    <script>
        const suite = new Benchmark.Suite;
        suite
            .add('parse with js export', () => shared.com.baconz.apolloperformance.parseWithJsExport())
            .add('parse with dnymaic reader', () => shared.com.baconz.apolloperformance.parseWithDynamicParser())
            .add('parse with buffer reader', () => shared.com.baconz.apolloperformance.parseWithBytesParser())
            .on('cycle', () => shared.com.baconz.apolloperformance.resetBuffer())
            .on('complete', function() {
                for (var i = 0; i < this.length; i++) {
                   console.log(this[i].name, this[i].hz + " ops/sec");
                   console.log(this[i].name, this[i].stats.sample.length + " runs");
                   //console.log(this[i].stats);
               }
               console.log('Fastest is ' + this.filter('fastest').map('name'));
               console.log('Slowest is ' + this.filter('slowest').map('name'));
            })
            .run({ 'async': true });
    </script>
</body>
</html>
